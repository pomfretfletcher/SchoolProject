using UnityEngine;
using System.Collections.Generic;

public class InvulnerabilityShield : MonoBehaviour, IsAbility, UsesCooldown
{
    // Script + Component Links
    PlayerController playerController;
    PlayerInputHandler playerInputHandler;
    CooldownTimer cooldownHandler;

    // Customizable Values
    public float duration;

    private void Awake()
    {
        // Grabs all linked scripts + components
        playerController = GameObject.Find("Player").GetComponent<PlayerController>();
        playerInputHandler = GameObject.Find("Player").GetComponent<PlayerInputHandler>();
        cooldownHandler = GetComponent<CooldownTimer>();
    }

    private void Start()
    {
        // Setup cooldown for how long boost lasts
        List<string> keyList = new List<string> { "duration" };
        List<float> lengthList = new List<float> { duration };
        cooldownHandler.SetupTimers(keyList, lengthList, this);
    }

    public void OnActivation() 
    { 
        StartShield(); 
    }

    public void StartShield()
    {
        // Make player invulnerable, set a timer, once the timer ends, they will no longer be invulnerable
        playerController.isInvulnerable = true;
        playerInputHandler.invulnerableFromAnotherSource = true;
        cooldownHandler.timerStatusDict["duration"] = 1;
    }

    public void CooldownEndProcess(string key)
    {
        // Deactivate invulnerability
        playerController.isInvulnerable = false;
        playerInputHandler.invulnerableFromAnotherSource = false;
    }
}
